<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width">
    <link rel="alternate" href="http://localhost:8080/feed.xml" type="application/rss+xml" title="somewhere to talk about ideas and projects and stuff like everyone else">
    <link rel="stylesheet" href="/style/main.css">
    <title>Javascript Templating Engine</title>
  </head>
  <body>
    <div class="whitebox">
      <div class="graybar top">
        <header class="top">
          <div class="slogan">somewhere to talk about random ideas and projects like everyone else</div><a href="/">
            <h1 class="logo">
              stuff
               <span class="byline">by antimatter15</span>
            </h1></a>
        </header>
      </div>
      <div id="main">
        <div class="sidebar">
          <div class="about">
            <p class="emph">
              Hi. I’m <b>Kevin Kwok</b>, and I’m currently a sophomore at <b>MIT</b>, 
              and this is my obligatory online presence or whatever.  
            </p>
            <p>
              I regularly updated this site from 2007, when I started it in elementary school, 
              to summer 2014, when it was unwittingly absorbed into an international phishing ring.
            </p>
            <p>
              But like a phoenix, hydra or the national deficit, the site is back 
              again bigger than ever (after a rather long gestation period).
            </p>
            <p>
              For more obnoxious autobiographical content 
              blended with bits of nostalgia for the old PHP-on-sketchy-free-webhosting days, click here.
            </p>
          </div><br>
          <section class="archive"><a href="/archive">
              <h2>Archive</h2></a>
            <ul>
              <li>
                <ul>
                  <li><a href="/2015/04"><span class="month">April</span> <span class="year">2015</span></a></li>
                </ul><br>
              </li>
              <li>
                <ul>
                  <li><a href="/2014/05"><span class="month">May</span> <span class="year">2014</span></a></li>
                  <li><a href="/2014/04"><span class="month">April</span> <span class="year">2014</span></a></li>
                  <li><a href="/2014/03"><span class="month">March</span> <span class="year">2014</span></a></li>
                  <li><a href="/2014/02"><span class="month">February</span> <span class="year">2014</span></a></li>
                  <li><a href="/2014/01"><span class="month">January</span> <span class="year">2014</span></a></li>
                </ul><br>
              </li>
              <li>
                <ul>
                  <li><a href="/2013/12"><span class="month">December</span> <span class="year">2013</span></a></li>
                  <li><a href="/2013/11"><span class="month">November</span> <span class="year">2013</span></a></li>
                  <li><a href="/2013/10"><span class="month">October</span> <span class="year">2013</span></a></li>
                  <li><a href="/2013/09"><span class="month">September</span> <span class="year">2013</span></a></li>
                  <li><a href="/2013/08"><span class="month">August</span> <span class="year">2013</span></a></li>
                  <li><a href="/2013/07"><span class="month">July</span> <span class="year">2013</span></a></li>
                  <li><a href="/2013/06"><span class="month">June</span> <span class="year">2013</span></a></li>
                  <li><a href="/2013/05"><span class="month">May</span> <span class="year">2013</span></a></li>
                  <li><a href="/2013/04"><span class="month">April</span> <span class="year">2013</span></a></li>
                  <li><a href="/2013/03"><span class="month">March</span> <span class="year">2013</span></a></li>
                  <li><a href="/2013/02"><span class="month">February</span> <span class="year">2013</span></a></li>
                  <li><a href="/2013/01"><span class="month">January</span> <span class="year">2013</span></a></li>
                </ul><br>
              </li>
              <li>
                <ul>
                  <li><a href="/2012/12"><span class="month">December</span> <span class="year">2012</span></a></li>
                  <li><a href="/2012/11"><span class="month">November</span> <span class="year">2012</span></a></li>
                  <li><a href="/2012/10"><span class="month">October</span> <span class="year">2012</span></a></li>
                  <li><a href="/2012/09"><span class="month">September</span> <span class="year">2012</span></a></li>
                  <li><a href="/2012/08"><span class="month">August</span> <span class="year">2012</span></a></li>
                  <li><a href="/2012/07"><span class="month">July</span> <span class="year">2012</span></a></li>
                  <li><a href="/2012/06"><span class="month">June</span> <span class="year">2012</span></a></li>
                  <li><a href="/2012/05"><span class="month">May</span> <span class="year">2012</span></a></li>
                  <li><a href="/2012/04"><span class="month">April</span> <span class="year">2012</span></a></li>
                  <li><a href="/2012/03"><span class="month">March</span> <span class="year">2012</span></a></li>
                  <li><a href="/2012/02"><span class="month">February</span> <span class="year">2012</span></a></li>
                  <li><a href="/2012/01"><span class="month">January</span> <span class="year">2012</span></a></li>
                </ul><br>
              </li>
              <li>
                <ul>
                  <li><a href="/2011/12"><span class="month">December</span> <span class="year">2011</span></a></li>
                  <li><a href="/2011/11"><span class="month">November</span> <span class="year">2011</span></a></li>
                  <li><a href="/2011/10"><span class="month">October</span> <span class="year">2011</span></a></li>
                  <li><a href="/2011/09"><span class="month">September</span> <span class="year">2011</span></a></li>
                  <li><a href="/2011/08"><span class="month">August</span> <span class="year">2011</span></a></li>
                  <li><a href="/2011/07"><span class="month">July</span> <span class="year">2011</span></a></li>
                  <li><a href="/2011/06"><span class="month">June</span> <span class="year">2011</span></a></li>
                  <li><a href="/2011/05"><span class="month">May</span> <span class="year">2011</span></a></li>
                  <li><a href="/2011/04"><span class="month">April</span> <span class="year">2011</span></a></li>
                  <li><a href="/2011/03"><span class="month">March</span> <span class="year">2011</span></a></li>
                  <li><a href="/2011/02"><span class="month">February</span> <span class="year">2011</span></a></li>
                  <li><a href="/2011/01"><span class="month">January</span> <span class="year">2011</span></a></li>
                </ul><br>
              </li>
              <li>
                <ul>
                  <li><a href="/2010/12"><span class="month">December</span> <span class="year">2010</span></a></li>
                  <li><a href="/2010/11"><span class="month">November</span> <span class="year">2010</span></a></li>
                  <li><a href="/2010/10"><span class="month">October</span> <span class="year">2010</span></a></li>
                  <li><a href="/2010/09"><span class="month">September</span> <span class="year">2010</span></a></li>
                  <li><a href="/2010/08"><span class="month">August</span> <span class="year">2010</span></a></li>
                  <li><a href="/2010/07"><span class="month">July</span> <span class="year">2010</span></a></li>
                  <li><a href="/2010/06"><span class="month">June</span> <span class="year">2010</span></a></li>
                  <li><a href="/2010/05"><span class="month">May</span> <span class="year">2010</span></a></li>
                  <li><a href="/2010/04"><span class="month">April</span> <span class="year">2010</span></a></li>
                  <li><a href="/2010/03"><span class="month">March</span> <span class="year">2010</span></a></li>
                  <li><a href="/2010/02"><span class="month">February</span> <span class="year">2010</span></a></li>
                  <li><a href="/2010/01"><span class="month">January</span> <span class="year">2010</span></a></li>
                </ul><br>
              </li>
              <li>
                <ul>
                  <li><a href="/2009/12"><span class="month">December</span> <span class="year">2009</span></a></li>
                  <li><a href="/2009/11"><span class="month">November</span> <span class="year">2009</span></a></li>
                  <li><a href="/2009/10"><span class="month">October</span> <span class="year">2009</span></a></li>
                  <li><a href="/2009/09"><span class="month">September</span> <span class="year">2009</span></a></li>
                  <li><a href="/2009/08"><span class="month">August</span> <span class="year">2009</span></a></li>
                  <li><a href="/2009/07"><span class="month">July</span> <span class="year">2009</span></a></li>
                  <li><a href="/2009/06"><span class="month">June</span> <span class="year">2009</span></a></li>
                  <li><a href="/2009/05"><span class="month">May</span> <span class="year">2009</span></a></li>
                  <li><a href="/2009/04"><span class="month">April</span> <span class="year">2009</span></a></li>
                  <li><a href="/2009/03"><span class="month">March</span> <span class="year">2009</span></a></li>
                  <li><a href="/2009/01"><span class="month">January</span> <span class="year">2009</span></a></li>
                </ul><br>
              </li>
              <li>
                <ul>
                  <li><a href="/2008/12"><span class="month">December</span> <span class="year">2008</span></a></li>
                  <li><a href="/2008/11"><span class="month">November</span> <span class="year">2008</span></a></li>
                  <li><a href="/2008/10"><span class="month">October</span> <span class="year">2008</span></a></li>
                  <li><a href="/2008/09"><span class="month">September</span> <span class="year">2008</span></a></li>
                  <li><a href="/2008/08"><span class="month">August</span> <span class="year">2008</span></a></li>
                  <li><a href="/2008/07"><span class="month">July</span> <span class="year">2008</span></a></li>
                  <li><a href="/2008/06"><span class="month">June</span> <span class="year">2008</span></a></li>
                  <li><a href="/2008/05"><span class="month">May</span> <span class="year">2008</span></a></li>
                  <li><a href="/2008/04"><span class="month">April</span> <span class="year">2008</span></a></li>
                  <li><a href="/2008/01"><span class="month">January</span> <span class="year">2008</span></a></li>
                </ul><br>
              </li>
              <li>
                <ul>
                  <li><a href="/2007/12"><span class="month">December</span> <span class="year">2007</span></a></li>
                  <li><a href="/2007/11"><span class="month">November</span> <span class="year">2007</span></a></li>
                  <li><a href="/2007/10"><span class="month">October</span> <span class="year">2007</span></a></li>
                  <li><a href="/2007/09"><span class="month">September</span> <span class="year">2007</span></a></li>
                  <li><a href="/2007/08"><span class="month">August</span> <span class="year">2007</span></a></li>
                  <li><a href="/2007/05"><span class="month">May</span> <span class="year">2007</span></a></li>
                </ul><br>
              </li>
            </ul>
          </section>
          <div class="tags">
            <h2>Tags</h2><a href="/tag/3D" style="font-size: 15px">3D </a><a href="/tag/ajax" style="font-size: 19.998766054240136px">ajax </a><a href="/tag/ajax animator" style="font-size: 19.99983298578152px">ajax animator </a><a href="/tag/api" style="font-size: 15px">api </a><a href="/tag/apple" style="font-size: 19.93307149075715px">apple </a><a href="/tag/art" style="font-size: 12.689414213699951px">art </a><a href="/tag/awesome" style="font-size: 15px">awesome </a><a href="/tag/blog" style="font-size: 17.31058578630005px">blog </a><a href="/tag/browser" style="font-size: 19.93307149075715px">browser </a><a href="/tag/bugfix" style="font-size: 17.31058578630005px">bugfix </a><a href="/tag/canvas" style="font-size: 15px">canvas </a><a href="/tag/change" style="font-size: 17.31058578630005px">change </a><a href="/tag/chrome" style="font-size: 19.999999998973813px">chrome </a><a href="/tag/chrome extension" style="font-size: 12.689414213699951px">chrome extension </a><a href="/tag/chrome os" style="font-size: 12.689414213699951px">chrome os </a><a href="/tag/chromebook" style="font-size: 12.689414213699951px">chromebook </a><a href="/tag/code" style="font-size: 15px">code </a><a href="/tag/color" style="font-size: 12.689414213699951px">color </a><a href="/tag/colors" style="font-size: 12.689414213699951px">colors </a><a href="/tag/css" style="font-size: 12.689414213699951px">css </a><a href="/tag/demo" style="font-size: 12.689414213699951px">demo </a><a href="/tag/design" style="font-size: 19.52574126822433px">design </a><a href="/tag/elitist" style="font-size: 19.820137900379084px">elitist </a><a href="/tag/evil" style="font-size: 19.52574126822433px">evil </a><a href="/tag/experiment" style="font-size: 15px">experiment </a><a href="/tag/extension" style="font-size: 19.820137900379084px">extension </a><a href="/tag/ExtJS" style="font-size: 19.820137900379084px">ExtJS </a><a href="/tag/facebook" style="font-size: 12.689414213699951px">facebook </a><a href="/tag/fast" style="font-size: 19.820137900379084px">fast </a><a href="/tag/features" style="font-size: 17.31058578630005px">features </a><a href="/tag/firefox" style="font-size: 19.975273768433652px">firefox </a><a href="/tag/flash" style="font-size: 18.807970779778824px">flash </a><a href="/tag/free" style="font-size: 12.689414213699951px">free </a><a href="/tag/function" style="font-size: 15px">function </a><a href="/tag/future" style="font-size: 17.31058578630005px">future </a><a href="/tag/GAE" style="font-size: 15px">GAE </a><a href="/tag/github" style="font-size: 17.31058578630005px">github </a><a href="/tag/google" style="font-size: 19.999999999999872px">google </a><a href="/tag/google code" style="font-size: 12.689414213699951px">google code </a><a href="/tag/google wave" style="font-size: 19.998766054240136px">google wave </a><a href="/tag/graphics" style="font-size: 15px">graphics </a><a href="/tag/hacking" style="font-size: 12.689414213699951px">hacking </a><a href="/tag/hosting" style="font-size: 19.52574126822433px">hosting </a><a href="/tag/html5" style="font-size: 19.52574126822433px">html5 </a><a href="/tag/idea" style="font-size: 15px">idea </a><a href="/tag/images" style="font-size: 12.689414213699951px">images </a><a href="/tag/interface" style="font-size: 12.689414213699951px">interface </a><a href="/tag/internet exploder" style="font-size: 19.820137900379084px">internet exploder </a><a href="/tag/ipad" style="font-size: 18.807970779778824px">ipad </a><a href="/tag/javascript" style="font-size: 19.99999999721053px">javascript </a><a href="/tag/json" style="font-size: 17.31058578630005px">json </a><a href="/tag/library" style="font-size: 12.689414213699951px">library </a><a href="/tag/lines" style="font-size: 15px">lines </a><a href="/tag/linux" style="font-size: 18.807970779778824px">linux </a><a href="/tag/login" style="font-size: 17.31058578630005px">login </a><a href="/tag/mac" style="font-size: 12.689414213699951px">mac </a><a href="/tag/magical" style="font-size: 17.31058578630005px">magical </a><a href="/tag/math" style="font-size: 12.689414213699951px">math </a><a href="/tag/meta" style="font-size: 12.689414213699951px">meta </a><a href="/tag/microsoft" style="font-size: 15px">microsoft </a><a href="/tag/microwave" style="font-size: 17.31058578630005px">microwave </a><a href="/tag/mirror" style="font-size: 12.689414213699951px">mirror </a><a href="/tag/mp3" style="font-size: 12.689414213699951px">mp3 </a><a href="/tag/multitouch" style="font-size: 15px">multitouch </a><a href="/tag/new" style="font-size: 19.52574126822433px">new </a><a href="/tag/nostalgia" style="font-size: 12.689414213699951px">nostalgia </a><a href="/tag/ocr" style="font-size: 12.689414213699951px">ocr </a><a href="/tag/offline" style="font-size: 18.807970779778824px">offline </a><a href="/tag/old" style="font-size: 18.807970779778824px">old </a><a href="/tag/onlypaths" style="font-size: 18.807970779778824px">onlypaths </a><a href="/tag/pi" style="font-size: 19.52574126822433px">pi </a><a href="/tag/player" style="font-size: 12.689414213699951px">player </a><a href="/tag/processing" style="font-size: 12.689414213699951px">processing </a><a href="/tag/prototype" style="font-size: 15px">prototype </a><a href="/tag/python" style="font-size: 19.93307149075715px">python </a><a href="/tag/raphael" style="font-size: 19.52574126822433px">raphael </a><a href="/tag/release" style="font-size: 15px">release </a><a href="/tag/rewrite" style="font-size: 15px">rewrite </a><a href="/tag/security" style="font-size: 15px">security </a><a href="/tag/shiny" style="font-size: 19.975273768433652px">shiny </a><a href="/tag/ShinyTouch" style="font-size: 15px">ShinyTouch </a><a href="/tag/site" style="font-size: 15px">site </a><a href="/tag/small" style="font-size: 19.52574126822433px">small </a><a href="/tag/speed" style="font-size: 12.689414213699951px">speed </a><a href="/tag/SVG" style="font-size: 17.31058578630005px">SVG </a><a href="/tag/touch" style="font-size: 15px">touch </a><a href="/tag/update" style="font-size: 19.999999943972036px">update </a><a href="/tag/upload" style="font-size: 18.807970779778824px">upload </a><a href="/tag/user interface" style="font-size: 12.689414213699951px">user interface </a><a href="/tag/vector" style="font-size: 15px">vector </a><a href="/tag/vectoreditor" style="font-size: 19.52574126822433px">vectoreditor </a><a href="/tag/version" style="font-size: 15px">version </a><a href="/tag/video" style="font-size: 17.31058578630005px">video </a><a href="/tag/vp8" style="font-size: 12.689414213699951px">vp8 </a><a href="/tag/vX JS" style="font-size: 19.52574126822433px">vX JS </a><a href="/tag/wave" style="font-size: 19.99999694097773px">wave </a><a href="/tag/webcam" style="font-size: 12.689414213699951px">webcam </a><a href="/tag/wikify" style="font-size: 19.820137900379084px">wikify </a><a href="/tag/wikipedia" style="font-size: 18.807970779778824px">wikipedia </a><a href="/tag/wordpress" style="font-size: 19.820137900379084px">wordpress </a>
          </div>
        </div>
        <div id="content">
          <h2>Javascript Templating Engine <span class="subtitle">20 July 2010</span>
          </h2>
          <article class="article">
            <section class="content"><p>Well, there are a bazillion other <span class="caps">JS</span> templating engines out there, and it’s pretty easy to say why: It’s really easy to make. You just take a regex string replace and stick an eval in there and hours of boredom makes something you think is unique despite being one or two bits of (non)functionality away from any other&nbsp;library.</p>
<p>This is, of course, totally un-unique or innovative in any imaginable way. I won’t bore you with concepts like “lightest and smallest ever” because it’s really&nbsp;not.</p>
<pre><code><span style='display:none' detected-language='coffeescript'></span><span class="hljs-regexp">//</span><span class="hljs-keyword">this</span> might be close .replace(<span class="hljs-regexp">/\{(.*)\}/g</span>,<span class="hljs-reserved">function</span>(a,b){<span class="hljs-keyword">return</span> eval(b)}) `<span class="javascript">&lt;<span class="hljs-regexp">/pre&gt;</span></span>
</code></pre><p>However, I feel compelled to do something utterly non-innovative or useful because everyone loves the <span class="caps">NIH</span> (Not Invented Here)&nbsp;syndrome.</p>
<p>Code is prefixed by the @ symbol, similar to Microsoft’s WebMatrix Razor stuff. It’s not modeled after Razor, but I just felt like using the @ symbol too. Or that microsoft planted an&nbsp;inception.</p>
<p>Blocks are like this: <code>@{+new Date}</code></p>
<p>Anything can go inside blocks pretty much, and they can be&nbsp;multiline.</p>
<pre><code><span style='display:none' detected-language='javascript'></span>@{
    <span class="hljs-keyword">var</span> now = (<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>).getTime();
    <span class="hljs-keyword">var</span> random = <span class="hljs-built_in">Math</span>.random() * <span class="hljs-built_in">Math</span>.pow(<span class="hljs-number">10</span>,<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.log(now)/<span class="hljs-built_in">Math</span>.log(<span class="hljs-number">10</span>)));
    <span class="hljs-keyword">var</span> magic = random - now;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; magic; i+= <span class="hljs-number">42</span>){
        magic -= <span class="hljs-built_in">Math</span>.<span class="caps">PI</span>;
    }
    magic
}
</code></pre><p>Take note about how amazingly awesome it is that despite being regexp powered, it can still handle the nested for-loops instead of puking it as a syntax-errored explosive&nbsp;somethingness.</p>
<p>The last non-whitespace line gets inserted into the html. You can optionally use ‘return magic’ but that doesn’t really do anything more except look more verbose. If you really just want to have code there for some reason, you can end it&nbsp;with</p>
<pre><code><span style='display:none' detected-language='sql'></span>@{
    //<span class="hljs-operator"><span class="hljs-keyword">do</span> <span class="hljs-keyword">stuff</span>
}</span>
</code></pre><p>Of course this is all boring. You can also do a shorthand notation.&nbsp;@name</p>
<p>This inserts the value of the variable “name”. There are a few rules about the shorthand&nbsp;notation.</p>
<pre><code><span style='display:none' detected-language='perl'></span><span class="hljs-variable">@name</span> //interpreted as <span class="hljs-variable">@{name}</span>
<span class="hljs-variable">@name</span> game //interpreted as <span class="hljs-variable">@{name}</span>
game \<span class="hljs-variable">@name</span> blame //<span class="hljs-keyword">not</span> interpreted at all, outputs as <span class="hljs-string">"<span class="hljs-variable">@name</span> blame"</span>
<span class="hljs-variable">@games_are_fun</span> //interpreted as <span class="hljs-variable">@{games_are_fun}</span>
<span class="hljs-variable">@name</span>=<span class="hljs-string">"bob"</span> //interpreted as @{name=<span class="hljs-string">"bob"</span>}
<span class="hljs-variable">@explosive</span>?<span class="hljs-string">'run'</span>:<span class="hljs-string">'poke'</span> //interpreted as @{explosive?<span class="hljs-string">'run'</span>:<span class="hljs-string">'poke'</span>
</code></pre><p>If you don’t want to end it with space, you can also end one with a&nbsp;semicolon;</p>
<p>Basically, it scans starting from an @ sign (unless the character immediately before is a \ which causes it to remove the \ and not parse the @). It includes everything until it encounters a whitespace&nbsp;character.</p>
<p>However, like any rule, there are&nbsp;exceptions.</p>
<pre><code><span style='display:none' detected-language='groovy'></span><span class="hljs-annotation">@format</span>_time(date + <span class="hljs-number">2</span> - <span class="hljs-number">5</span><span class="hljs-regexp">/64) /</span><span class="hljs-regexp">/interpreted as @{format_time(date + 2 - 5/</span><span class="hljs-number">64</span>)}
<span class="hljs-annotation">@blah</span>(<span class="hljs-number">234</span> + <span class="hljs-number">2</span>) + <span class="hljs-number">45</span> <span class="hljs-comment">//interpreted as @{blah(234 + 2)} + 42</span>
<span class="hljs-annotation">@blah</span>(<span class="hljs-number">234</span> + <span class="hljs-number">2</span>)+<span class="hljs-number">45</span> <span class="hljs-comment">//interpreted as @{blah(234 + 2)}+42</span>
<span class="hljs-annotation">@blah</span>(<span class="hljs-number">234</span>+<span class="hljs-number">2</span>)+<span class="hljs-number">45</span> <span class="hljs-comment">//interpreted as @{blah(234+2)}+42</span>
</code></pre><p>Note that the last three examples demonstrate a sort of unexpected behavior. The function call pattern takes precedence over the include-until-whitespace behavior, because I dont really feel bothered by it and don’t feel like fixing&nbsp;it.</p>
<p>And if you don’t feel like doing <span class="caps">JS</span> stuff, you can also do some neat things like ifs and loops
    @explosive? OH NOES! &lt;strong&gt;RUUUNNN&lt;/strong&gt;
    @else Well, i guess it’s safe. &lt;em&gt;let’s poke it!&lt;/em&gt; @/
    @if(boom) No comment.&nbsp;@end</p>
<p>Here you can see that there are two ways to start an if. You can postfix it with a ? or you can start it with if(condition). This probably won’t ever be useful, but the latest if value gets saved to the @_ifval&nbsp;value.</p>
<p>There are also two ways of ending a block. You can @end or @/. Both are the same, but one’s&nbsp;shorter.</p>
<p>What about looping arrays and objects? It can do that&nbsp;too.</p>
<pre><code><span style='display:none' detected-language='scala'></span><span class="hljs-annotation">@each</span>(numbers, number) <span class="hljs-annotation">@number</span> is a magical number, presumably a real number.
@/ <span class="hljs-annotation">@each</span>(pets, name, index)
<span class="hljs-type">Aww</span>, look at how cute <span class="hljs-annotation">@name</span> is! <span class="hljs-type">He</span> is my <span class="hljs-annotation">@index</span>+<span class="hljs-number">1</span>;<span class="hljs-symbol">'th</span> pet
@/ <span class="hljs-annotation">@each</span>(<span class="hljs-keyword">new</span> <span class="hljs-type">Array</span>(<span class="hljs-number">50</span>)) <span class="hljs-type"><span class="caps">SPAM</span></span> <span class="hljs-annotation">@end</span>
<span class="hljs-annotation">@each</span>(users, password, username)
<span class="hljs-type">The</span> password of <span class="hljs-annotation">@username</span> is <span class="hljs-annotation">@password</span> @/
</code></pre><p>Note that the loop terminators are the same as the if terminators. Neat isn’t&nbsp;it.</p>
<p>So now that I’ve demonstrated there’s nothing interesting about this solution, go on and leave this document before I explain to you something that’s utterly useless and that you shouldn’t&nbsp;use.</p>
<p>Probably the most distinguishing feature is something I call blocks. That’s probably a really really bad name and it probably will get people confused with other things, but as the name of this library is “templating” I can’t imagine anyone who didn’t find this expected. I haven’t even hung around the guys who make Prototype or&nbsp;Closure.</p>
<p>So. Blocks. They’re an okay-ish feature that allows for event-based updates of certain sections of the template after the initial rendering. It’s a feature that doesn’t even belong as part of the templating engine, so it sort of isn’t. It’s part of the execute() function, which doesn’t really count as the templating engine. That’s the function which takes your variables and code sticks it through templating, and evals() the result. It also handles&nbsp;blocks.</p>
<pre><code><span style='display:none' detected-language='handlebars'></span><span class="xml">@time.span</span><span class="hljs-expression">{{{
    /<span class="hljs-end-block">/har har har i love puns It is now </span>@<span class="hljs-variable">format</span>_<span class="hljs-variable">time</span>(+<span class="hljs-variable">new</span> <span class="hljs-variable">Date</span>)
}}</span><span class="xml">}
@{
    setInterval(function(){time()},1000)
}</span>
</code></pre><p>Here we see a block being created, and a piece of attached js which updates the block every second. But blocks can also have triggers that aren’t just timeouts and other boring&nbsp;stuff.</p>
<pre><code><span style='display:none' detected-language='handlebars'></span><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">"#update_time"</span> <span class="hljs-attribute">onclick</span>=<span class="hljs-value">"@</span></span></span><span class="hljs-expression">{{{ <span class="hljs-variable">time</span>(); }}</span><span class="xml"><span class="hljs-tag"><span class="hljs-value">};return false"</span>&gt;</span>Update the time<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span>;</span>
</code></pre><p>The way blocks work are pretty simple. It basically creates a function out of the compiled template and then it associates it with a function in the scope of the template. It wraps&nbsp;a</p>
<p>or (based on whether the block name ends with .span or .div or .bacon) and gives it an <span class="caps">ID</span> of a random number. This random number is stored in the scope of the&nbsp;template.</p>
<p>When the associated update function is called, it looks up the associated <span class="caps">ID</span> number and tries to do a document.getElementById and re-executes the template in the previous scope and then replaces the innerHTML. Basically enabling live&nbsp;templates.</p>
<p>Its all <span class="caps">3KB</span> before gzip (minified). Not that bad, but still, compared to fifty four bytes in the code from the introduction, it’s&nbsp;huuge.</p>
<p>Possible&nbsp;changes:</p>
<ul>
<li><code>name.el_id.interval{{{ }}}</code> block notation for auto updating chronologically. Probably useful for the twitter/facebook style real-time relative&nbsp;dates.</li>
</ul>
</section>
          </article>
          <div>
            <ul class="tags">
            </ul>
          </div><br>
          <div class="splitter">
            <hr>comments
          </div><br><div id="disqus_thread"></div>
          <script>
            var disqus_shortname = 'antimatter15',
                disqus_title = 'Javascript Templating Engine',
                disqus_url = 'https://antimatter15.com/2010/07/javascript-templating-engine/';
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
          </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
        </div>
      </div>
    </div>
    <script>
      function squish(){
        document.getElementById("squishfoot").className += "squish"
      }
    </script>
    <style>
      .squish { font-size: 9px }
      .squishsquish { font-size: 8px }
      .squishsquishsquish { font-size: 7px }
      .squishsquishsquishsquish { font-size: 6px }
      .squishsquishsquishsquishsquish { font-size: 5px }
      .squishsquishsquishsquishsquishsquish { font-size: 4px }
      .squishsquishsquishsquishsquishsquishsquish { visibility: hidden }
    </style>
    <div class="graybar bottom">
      <footer>
        <div id="squishfoot">I'm a tiny footer, please don't <a href="javascript:squish()">squish</a> me</div>
      </footer>
    </div>
  </body>
</html>