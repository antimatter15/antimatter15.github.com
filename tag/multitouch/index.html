<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width">
    <link rel="alternate" href="http://localhost:8080/feed.xml" type="application/rss+xml" title="somewhere to talk about ideas and projects and stuff like everyone else">
    <link rel="stylesheet" href="/style/main.css">
    <title>#multitouch</title>
  </head>
  <body>
    <div class="whitebox">
      <div class="graybar top">
        <header class="top">
          <div class="slogan">somewhere to talk about random ideas and projects like everyone else</div><a href="/">
            <h1 class="logo">
              stuff
               <span class="byline">by antimatter15</span>
            </h1></a>
        </header>
      </div>
      <div id="main">
        <div class="sidebar">
          <div class="about">
            <p class="emph">
              Hi. I’m <b>Kevin Kwok</b>, and I’m currently a sophomore at <b>MIT</b>, 
              and this is my obligatory online presence or whatever.  
            </p>
            <p>
              I regularly updated this site from 2007, when I started it in elementary school, 
              to summer 2014, when it was unwittingly absorbed into an international phishing ring.
            </p>
            <p>
              But like a phoenix, hydra or the national deficit, the site is back 
              again bigger than ever (after a rather long gestation period).
            </p>
            <p>
              For more obnoxious autobiographical content 
              blended with bits of nostalgia for the old PHP-on-sketchy-free-webhosting days, click here.
            </p>
          </div><br>
          <section class="archive"><a href="/archive">
              <h2>Archive</h2></a>
            <ul>
              <li>
                <ul>
                  <li><a href="/2015/04"><span class="month">April</span> <span class="year">2015</span></a></li>
                </ul><br>
              </li>
              <li>
                <ul>
                  <li><a href="/2014/05"><span class="month">May</span> <span class="year">2014</span></a></li>
                  <li><a href="/2014/04"><span class="month">April</span> <span class="year">2014</span></a></li>
                  <li><a href="/2014/03"><span class="month">March</span> <span class="year">2014</span></a></li>
                  <li><a href="/2014/02"><span class="month">February</span> <span class="year">2014</span></a></li>
                  <li><a href="/2014/01"><span class="month">January</span> <span class="year">2014</span></a></li>
                </ul><br>
              </li>
              <li>
                <ul>
                  <li><a href="/2013/12"><span class="month">December</span> <span class="year">2013</span></a></li>
                  <li><a href="/2013/11"><span class="month">November</span> <span class="year">2013</span></a></li>
                  <li><a href="/2013/10"><span class="month">October</span> <span class="year">2013</span></a></li>
                  <li><a href="/2013/09"><span class="month">September</span> <span class="year">2013</span></a></li>
                  <li><a href="/2013/08"><span class="month">August</span> <span class="year">2013</span></a></li>
                  <li><a href="/2013/07"><span class="month">July</span> <span class="year">2013</span></a></li>
                  <li><a href="/2013/06"><span class="month">June</span> <span class="year">2013</span></a></li>
                  <li><a href="/2013/05"><span class="month">May</span> <span class="year">2013</span></a></li>
                  <li><a href="/2013/04"><span class="month">April</span> <span class="year">2013</span></a></li>
                  <li><a href="/2013/03"><span class="month">March</span> <span class="year">2013</span></a></li>
                  <li><a href="/2013/02"><span class="month">February</span> <span class="year">2013</span></a></li>
                  <li><a href="/2013/01"><span class="month">January</span> <span class="year">2013</span></a></li>
                </ul><br>
              </li>
              <li>
                <ul>
                  <li><a href="/2012/12"><span class="month">December</span> <span class="year">2012</span></a></li>
                  <li><a href="/2012/11"><span class="month">November</span> <span class="year">2012</span></a></li>
                  <li><a href="/2012/10"><span class="month">October</span> <span class="year">2012</span></a></li>
                  <li><a href="/2012/09"><span class="month">September</span> <span class="year">2012</span></a></li>
                  <li><a href="/2012/08"><span class="month">August</span> <span class="year">2012</span></a></li>
                  <li><a href="/2012/07"><span class="month">July</span> <span class="year">2012</span></a></li>
                  <li><a href="/2012/06"><span class="month">June</span> <span class="year">2012</span></a></li>
                  <li><a href="/2012/05"><span class="month">May</span> <span class="year">2012</span></a></li>
                  <li><a href="/2012/04"><span class="month">April</span> <span class="year">2012</span></a></li>
                  <li><a href="/2012/03"><span class="month">March</span> <span class="year">2012</span></a></li>
                  <li><a href="/2012/02"><span class="month">February</span> <span class="year">2012</span></a></li>
                  <li><a href="/2012/01"><span class="month">January</span> <span class="year">2012</span></a></li>
                </ul><br>
              </li>
              <li>
                <ul>
                  <li><a href="/2011/12"><span class="month">December</span> <span class="year">2011</span></a></li>
                  <li><a href="/2011/11"><span class="month">November</span> <span class="year">2011</span></a></li>
                  <li><a href="/2011/10"><span class="month">October</span> <span class="year">2011</span></a></li>
                  <li><a href="/2011/09"><span class="month">September</span> <span class="year">2011</span></a></li>
                  <li><a href="/2011/08"><span class="month">August</span> <span class="year">2011</span></a></li>
                  <li><a href="/2011/07"><span class="month">July</span> <span class="year">2011</span></a></li>
                  <li><a href="/2011/06"><span class="month">June</span> <span class="year">2011</span></a></li>
                  <li><a href="/2011/05"><span class="month">May</span> <span class="year">2011</span></a></li>
                  <li><a href="/2011/04"><span class="month">April</span> <span class="year">2011</span></a></li>
                  <li><a href="/2011/03"><span class="month">March</span> <span class="year">2011</span></a></li>
                  <li><a href="/2011/02"><span class="month">February</span> <span class="year">2011</span></a></li>
                  <li><a href="/2011/01"><span class="month">January</span> <span class="year">2011</span></a></li>
                </ul><br>
              </li>
              <li>
                <ul>
                  <li><a href="/2010/12"><span class="month">December</span> <span class="year">2010</span></a></li>
                  <li><a href="/2010/11"><span class="month">November</span> <span class="year">2010</span></a></li>
                  <li><a href="/2010/10"><span class="month">October</span> <span class="year">2010</span></a></li>
                  <li><a href="/2010/09"><span class="month">September</span> <span class="year">2010</span></a></li>
                  <li><a href="/2010/08"><span class="month">August</span> <span class="year">2010</span></a></li>
                  <li><a href="/2010/07"><span class="month">July</span> <span class="year">2010</span></a></li>
                  <li><a href="/2010/06"><span class="month">June</span> <span class="year">2010</span></a></li>
                  <li><a href="/2010/05"><span class="month">May</span> <span class="year">2010</span></a></li>
                  <li><a href="/2010/04"><span class="month">April</span> <span class="year">2010</span></a></li>
                  <li><a href="/2010/03"><span class="month">March</span> <span class="year">2010</span></a></li>
                  <li><a href="/2010/02"><span class="month">February</span> <span class="year">2010</span></a></li>
                  <li><a href="/2010/01"><span class="month">January</span> <span class="year">2010</span></a></li>
                </ul><br>
              </li>
              <li>
                <ul>
                  <li><a href="/2009/12"><span class="month">December</span> <span class="year">2009</span></a></li>
                  <li><a href="/2009/11"><span class="month">November</span> <span class="year">2009</span></a></li>
                  <li><a href="/2009/10"><span class="month">October</span> <span class="year">2009</span></a></li>
                  <li><a href="/2009/09"><span class="month">September</span> <span class="year">2009</span></a></li>
                  <li><a href="/2009/08"><span class="month">August</span> <span class="year">2009</span></a></li>
                  <li><a href="/2009/07"><span class="month">July</span> <span class="year">2009</span></a></li>
                  <li><a href="/2009/06"><span class="month">June</span> <span class="year">2009</span></a></li>
                  <li><a href="/2009/05"><span class="month">May</span> <span class="year">2009</span></a></li>
                  <li><a href="/2009/04"><span class="month">April</span> <span class="year">2009</span></a></li>
                  <li><a href="/2009/03"><span class="month">March</span> <span class="year">2009</span></a></li>
                  <li><a href="/2009/01"><span class="month">January</span> <span class="year">2009</span></a></li>
                </ul><br>
              </li>
              <li>
                <ul>
                  <li><a href="/2008/12"><span class="month">December</span> <span class="year">2008</span></a></li>
                  <li><a href="/2008/11"><span class="month">November</span> <span class="year">2008</span></a></li>
                  <li><a href="/2008/10"><span class="month">October</span> <span class="year">2008</span></a></li>
                  <li><a href="/2008/09"><span class="month">September</span> <span class="year">2008</span></a></li>
                  <li><a href="/2008/08"><span class="month">August</span> <span class="year">2008</span></a></li>
                  <li><a href="/2008/07"><span class="month">July</span> <span class="year">2008</span></a></li>
                  <li><a href="/2008/06"><span class="month">June</span> <span class="year">2008</span></a></li>
                  <li><a href="/2008/05"><span class="month">May</span> <span class="year">2008</span></a></li>
                  <li><a href="/2008/04"><span class="month">April</span> <span class="year">2008</span></a></li>
                  <li><a href="/2008/01"><span class="month">January</span> <span class="year">2008</span></a></li>
                </ul><br>
              </li>
              <li>
                <ul>
                  <li><a href="/2007/12"><span class="month">December</span> <span class="year">2007</span></a></li>
                  <li><a href="/2007/11"><span class="month">November</span> <span class="year">2007</span></a></li>
                  <li><a href="/2007/10"><span class="month">October</span> <span class="year">2007</span></a></li>
                  <li><a href="/2007/09"><span class="month">September</span> <span class="year">2007</span></a></li>
                  <li><a href="/2007/08"><span class="month">August</span> <span class="year">2007</span></a></li>
                  <li><a href="/2007/05"><span class="month">May</span> <span class="year">2007</span></a></li>
                </ul><br>
              </li>
            </ul>
          </section>
          <div class="tags">
            <h2>Tags</h2><a href="/tag/3D" style="font-size: 13px">3D </a><a href="/tag/actionscript" style="font-size: 11px">actionscript </a><a href="/tag/ajax" style="font-size: 20px">ajax </a><a href="/tag/ajax animator" style="font-size: 20px">ajax animator </a><a href="/tag/animation" style="font-size: 11px">animation </a><a href="/tag/api" style="font-size: 13px">api </a><a href="/tag/apple" style="font-size: 20px">apple </a><a href="/tag/art" style="font-size: 11px">art </a><a href="/tag/awesome" style="font-size: 13px">awesome </a><a href="/tag/blog" style="font-size: 15px">blog </a><a href="/tag/browser" style="font-size: 20px">browser </a><a href="/tag/bugfix" style="font-size: 15px">bugfix </a><a href="/tag/canvas" style="font-size: 15px">canvas </a><a href="/tag/change" style="font-size: 15px">change </a><a href="/tag/chrome" style="font-size: 20px">chrome </a><a href="/tag/chrome extension" style="font-size: 11px">chrome extension </a><a href="/tag/chrome os" style="font-size: 11px">chrome os </a><a href="/tag/chromebook" style="font-size: 11px">chromebook </a><a href="/tag/code" style="font-size: 13px">code </a><a href="/tag/color" style="font-size: 11px">color </a><a href="/tag/colors" style="font-size: 11px">colors </a><a href="/tag/css" style="font-size: 11px">css </a><a href="/tag/demo" style="font-size: 11px">demo </a><a href="/tag/design" style="font-size: 19px">design </a><a href="/tag/elitist" style="font-size: 20px">elitist </a><a href="/tag/evil" style="font-size: 19px">evil </a><a href="/tag/experiment" style="font-size: 13px">experiment </a><a href="/tag/extension" style="font-size: 20px">extension </a><a href="/tag/ExtJS" style="font-size: 20px">ExtJS </a><a href="/tag/facebook" style="font-size: 11px">facebook </a><a href="/tag/fast" style="font-size: 20px">fast </a><a href="/tag/features" style="font-size: 15px">features </a><a href="/tag/firefox" style="font-size: 20px">firefox </a><a href="/tag/flash" style="font-size: 17px">flash </a><a href="/tag/function" style="font-size: 13px">function </a><a href="/tag/future" style="font-size: 15px">future </a><a href="/tag/GAE" style="font-size: 13px">GAE </a><a href="/tag/github" style="font-size: 15px">github </a><a href="/tag/google" style="font-size: 20px">google </a><a href="/tag/google code" style="font-size: 11px">google code </a><a href="/tag/google wave" style="font-size: 20px">google wave </a><a href="/tag/graphics" style="font-size: 13px">graphics </a><a href="/tag/hacking" style="font-size: 11px">hacking </a><a href="/tag/hosting" style="font-size: 19px">hosting </a><a href="/tag/html5" style="font-size: 19px">html5 </a><a href="/tag/idea" style="font-size: 13px">idea </a><a href="/tag/images" style="font-size: 11px">images </a><a href="/tag/interface" style="font-size: 11px">interface </a><a href="/tag/internet exploder" style="font-size: 20px">internet exploder </a><a href="/tag/ipad" style="font-size: 17px">ipad </a><a href="/tag/javascript" style="font-size: 20px">javascript </a><a href="/tag/json" style="font-size: 15px">json </a><a href="/tag/library" style="font-size: 11px">library </a><a href="/tag/lines" style="font-size: 13px">lines </a><a href="/tag/linux" style="font-size: 17px">linux </a><a href="/tag/login" style="font-size: 15px">login </a><a href="/tag/mac" style="font-size: 11px">mac </a><a href="/tag/magical" style="font-size: 15px">magical </a><a href="/tag/meta" style="font-size: 11px">meta </a><a href="/tag/microsoft" style="font-size: 13px">microsoft </a><a href="/tag/microwave" style="font-size: 15px">microwave </a><a href="/tag/mirror" style="font-size: 11px">mirror </a><a href="/tag/mp3" style="font-size: 11px">mp3 </a><a href="/tag/multitouch" style="font-size: 13px">multitouch </a><a href="/tag/new" style="font-size: 19px">new </a><a href="/tag/nostalgia" style="font-size: 11px">nostalgia </a><a href="/tag/ocr" style="font-size: 11px">ocr </a><a href="/tag/offline" style="font-size: 17px">offline </a><a href="/tag/old" style="font-size: 17px">old </a><a href="/tag/onlypaths" style="font-size: 17px">onlypaths </a><a href="/tag/pi" style="font-size: 19px">pi </a><a href="/tag/player" style="font-size: 11px">player </a><a href="/tag/processing" style="font-size: 11px">processing </a><a href="/tag/progress" style="font-size: 11px">progress </a><a href="/tag/prototype" style="font-size: 13px">prototype </a><a href="/tag/python" style="font-size: 20px">python </a><a href="/tag/raphael" style="font-size: 19px">raphael </a><a href="/tag/release" style="font-size: 13px">release </a><a href="/tag/rewrite" style="font-size: 13px">rewrite </a><a href="/tag/security" style="font-size: 13px">security </a><a href="/tag/shiny" style="font-size: 20px">shiny </a><a href="/tag/ShinyTouch" style="font-size: 13px">ShinyTouch </a><a href="/tag/site" style="font-size: 13px">site </a><a href="/tag/small" style="font-size: 19px">small </a><a href="/tag/SVG" style="font-size: 15px">SVG </a><a href="/tag/touch" style="font-size: 13px">touch </a><a href="/tag/update" style="font-size: 20px">update </a><a href="/tag/upload" style="font-size: 17px">upload </a><a href="/tag/user interface" style="font-size: 11px">user interface </a><a href="/tag/vector" style="font-size: 13px">vector </a><a href="/tag/vectoreditor" style="font-size: 19px">vectoreditor </a><a href="/tag/version" style="font-size: 13px">version </a><a href="/tag/video" style="font-size: 15px">video </a><a href="/tag/vp8" style="font-size: 11px">vp8 </a><a href="/tag/vX JS" style="font-size: 19px">vX JS </a><a href="/tag/wave" style="font-size: 20px">wave </a><a href="/tag/webcam" style="font-size: 11px">webcam </a><a href="/tag/wikify" style="font-size: 20px">wikify </a><a href="/tag/wikipedia" style="font-size: 17px">wikipedia </a><a href="/tag/wordpress" style="font-size: 20px">wordpress </a>
          </div>
        </div>
        <div id="content">
          <h1>#multitouch</h1>
          <article class="article intro">
            <header>
              <h2><a href="/2012/08/determining-if-a-mousewheel-event-results-in-scroll/">Determining if a Mousewheel Event Results in Scroll</a> <span class="subtitle">14 August 2012</span></h2>
            </header>
            <section class="content"><p><a href="/articles/2012/Determining%20if%20a%20Mousewheel%20Event%20Results%20in%20Scroll/nuUgy.png"><img src="/articles/2012/Determining%20if%20a%20Mousewheel%20Event%20Results%20in%20Scroll/nuUgy.png" alt="" title="nuUgy"></a></p>
<p>So here’s a somewhat technical post, actually it’s pretty technical. But either way the premise is sort of simple to understand, and probably so is the context. I’m working on Swipe Gesture 2.0, which basically tries to take Chrome and Safari on <span class="caps">OS</span> X Lion’s awesome back-forward transitions and make them work on other operating systems. See, the thing is that multitouch isn’t _strictly _a requirement for it to work, a lot of computers just have the little bars on the bottom and right of the track bar (often with a little somewhat abrasive textured surface so you don’t accidentally tread upon it). Regardless, the title is a bit of a misnomer, because even though the event is called the “mousewheel”, it’s hardly meant to be observed from an actual mouse (or a wheel), instead it means the scrolling gesture on some kind of trackpad, either multitouch or&nbsp;not.</p>
<p>Well, first, I guess I’ll talk about the difference between how Lion and Leopard do it. The way Leopard did it was pretty cool but not particularly applicable to other platforms since it relied on the existence of a three-finger gesture. As in, you needed some kind of touchpad which was cool enough to support three-finger multiouch, <em>reliably</em>. It also behaved completely independent of the current zoom or scroll position, which makes implementation in software entirely trivial given access to some drivers which can recognize three fingers on a&nbsp;touchpad.</p>
<p>Lion did it a completely different way. Instead of creating an entirely new gesture which was entirely dedicated to the singular task of navigating through history, it conflated the notions of scrolling with navigating, which sort of makes sense. Apple’s quite dedicated to skeuomorphic metaphors, and they want to treat the web more like <em>literal pages</em>. A user can move it around to better keep certain things in view, and the physical movement to slide a sheet out of view is just an extension of that panning&nbsp;gesture.</p>
<p>However, technically this poses a completely different challenge, because this requires you to distinguish between scrolls and navigation requests. Scrolling is always the default behavior, but the navigation swipe gesture happens when scrolling wouldn’t actually result in anything. However, many implementations of scrolling are at least somewhat kinetic, often it’s emphasized in software (in the form of smooth-scrolling) or hardware (scroll wheels that don’t click but instead move basically freely) or because your arm has to obey the laws of kinematics (unless it doesn’t, in which case that’s certainly fascinating). So not only does the software have to determine when a mouse wheel action results manifests as a scroll, it has to see if it was the user’s intent to do the extraneous&nbsp;scrolling.</p>
<p>This is done by clustering the mouse wheel movements together temporally. Scroll events flow in in discrete chunks, and you can split events off into little buckets (in a sense), where if there isn’t any event sent within some arbitrary threshold (say, 500msecs or half a second), you stick stuff in a new bucket. This way, lets say you scroll from the top of the page to the bottom and you’re sort of excited, and spin the wheel as fast as possible, you hit the bottom of the page but it’s not some instant stop. You continue scrolling (because you’re just that excited, and just can’t stop) for a little bit more. Ignoring the fact that you probably won’t have a vertical/horizontal event handler (though there are some sort of intriguing possibilities for this, one idea is to have the upper threshold trigger full screen). Without segmenting them into certain buckets, it doesn’t recognize that the time when you’re ramming into the top of the page is part of the same general gesture as when you were scrolling, and it may interpret that as an intentional gesture. So that’s one part which makes it a bit more&nbsp;complex.</p>
<p>So now, you have these series of <code>mousewheel</code> events conveniently delimited into little gesture-chunks. The next part is determining whether or not the gesture-chunks are part of a scroll action or&nbsp;not.</p>
<p>Thankfully that’s a really simple thing to do. Just look at the document’s scrollTop and check if it’s zero (or scrollLeft for horizontal stuff) or whatever value is the width of the element. If it can’t scroll no more, then you have a winner and you can start the falling balloons and&nbsp;confetti.</p>
<p>Except it’s not that easy, because the document isn’t the only thing which can scroll. Thanks to the glory of <code>overflow:scroll</code>, there are lots of things which can scroll. Things which aren’t necessarily documents may be in arbitrary scroll positions to wreak havoc on your well-meaning&nbsp;heuristics.</p>
<p>So back to the drawing board, I guess. Actually, to think of it, maybe it’s simpler to listen for the <code>scroll</code> event, which fires when a scroll happens, and quite intuitively doesn’t fire when a scroll doesn’t happen. And mouse wheel actions always precede scroll ones (because the wheel events bubble and are cancelable, so you can prevent a scroll from happening). The only problem is that scroll events don’t bubble. As in, when a scroll event happens on some element, it’s not going to show up on the document, it’s only going to show up if you’re listening on that specific element at the right point in&nbsp;time.</p>
<p>The naive approach to this dilemma is just to attach a scroll listener to every single event on the document, and to reattach to some other elements whenever the <span class="caps">DOM</span> tree is modified in some way. This means the overhead grows rather significantly when pages are larger, in a way which could be likened to O(n) time where n represents the number of nodes in the document. If you want, you could lazily do it by attaching the scroll listener only once the wheel event has fired, but that would cause a significant delay when attempting to legitimately&nbsp;scroll.</p>
<p>Another thing you could do, is to make another assumption: that the element which gets scrolled has to be some parent of the element which the mouse is currently over. Making that assumption, we can add a <code>mousewheel</code> listener to the root of the document, as those kinds of events actually do bubble. And since they’re mouse events, once you capture it, you can get a <code>clientX</code> and <code>clientY</code>, comprising the current coordinates of the mouse. And with that, you can get the element immediately below the cursor with <code>document.elementFromPoint</code>. And since the scroll might fire on any one of the elements which are parents of the current element, you ascend up the tree and add a listener on all of those (until, of course you hit the document element, at which point you can’t go any further up). This yields performance which could essentially be modeled with O(log n), quite a bit better than&nbsp;O(n).</p>
<p>So now the finished process is fairly simple, you listen for a mousewheel event, and when it happens we determine the element, and ascend the tree, yada yada. That scroll listener, when fired, sets a global variable <code>lastDetectedScroll</code> to the current timestamp. We set a little temporary variable set to the before time and then we set a little timer, 150 milliseconds. It usually only takes like four to see if a scroll thingy happened, but let’s be safe by having an order-of-magnitude threshold. The Cuckoo clock rings, and we check if the <code>lastDetectedScroll</code> is the same thing, and if it is, it’s a swipe, and otherwise, it’s a&nbsp;scroll.</p>
<p>Here’s a little demo: <a href="http://antimatter15.com/misc/experiments/swipe-gesture/minimal.html">http://antimatter15.com/misc/experiments/swipe-gesture/minimal.html</a></p>

            </section>
          </article>
          <hr>
          <article class="article intro">
            <header>
              <h2><a href="/2012/08/swipe-gesture-for-chrome/">Swipe Gesture for Chrome</a> <span class="subtitle">13 August 2012</span></h2>
            </header>
            <section class="content"><p><a href="/articles/2012/Swipe%20Gesture%20for%20Chrome/unnamed.png"><img src="/articles/2012/Swipe%20Gesture%20for%20Chrome/unnamed-300x187.png" alt="" title="unnamed"></a></p>
<p>Here’s an extension which I actually released<a href="https://plus.google.com/116347431032639424492/posts/K4xgL8SKKQU"> some time back</a>, but never got around to writing a blog post for. Part of the reason was that the early reviews didn’t quite pan out, in large part due to <em>not working</em>. But I was using my Chromebook and I somehow felt a vague longing for some kind of multitouch gesture, and remembered that I had made this little extension (which I had disabled for some reason). Anyway, this is as appropriate a time as any to formally announce it to my probably remarkably small blog&nbsp;readership.</p>
<p>There is, however a tad bit of difficulty representing the function of it in pictures because really, it doesn’t have a big <span class="caps">UI</span>. It makes hardware more useful, and in its idealized form, should have no interface. But of course, we don’t live in a place where apps are perfectly idealized and either way, Apple has <a href="http://www.apple.com/osx/what-is/gestures.html">plenty of nice pretty pictures</a> of people swiping fingers to the&nbsp;right.</p>
<p>I really fell in love with the Macbook multitouch gestures, almost at first sight. They just seemed so natural and so beautiful that I sort of felt that that was like the epitome of design or <span class="caps">HCI</span> perfection. And from that point, any time I used a laptop which wasn’t made by Apple (or even the ones which were made by Apple but were stuck in the barbaric ages preceding the inclusion of the glass multitouch pad, where its invention might have produced a <a href="http://en.wikipedia.org/wiki/File:Creaci%C3%B3n_de_Ad%C3%A1n.jpg">scene like this</a>), I felt thoroughly&nbsp;disgusted.</p>
<p>Flipping through the Chromium <span class="caps">OS</span> design papers, there is one page dedicated specifically to<a href="http://dev.chromium.org/user-experience/multitouch"> cool multitouch gestures</a> which could be used. And as far as I’m aware the Samsung Series 5 550 (the new chromebook) is the only device which supports these gestures (thus far), and even then it’s only pinch to zoom and forward/back (three finger). All the other Chromebook users have been left&nbsp;out.</p>
<p>Another cool thing about the implementation is that it uses a certain <code>webkitDirectionInvertedFromDevice</code> property of the <code>mousewheel</code> events, which gives you a boolean value about whether or not the platform you’re on has some magical direction inversion like on <span class="caps">OS</span> X Lion or if you’ve enabled “simple scrolling” on Chrome OS. But this might not have been a good idea since swipe directions too are sort of inverted on those platforms naturally as well, so it might be better to _not _compensate for&nbsp;it.</p>
<p>Anyway, the implementation is actually quite simple. The current version doesn’t even break the 40 line mark, because all it does it it listens for <code>mousewheel</code> events on every page (via a content script), and it calculates the current acceleration. If that acceleration ever passes a certain threshold, it triggers a forward or back action. Right now, the threshold is preconfigured based on my own testing on a Samsung Series 5 (note, not 550) chromebook. But for people with other devices, I’m working on a second version which will be slightly more Apple-esque in its&nbsp;implementation.</p>

            </section>
          </article>
          <hr>
          <article class="article intro">
            <header>
              <h2><a href="/2012/04/chrome-multitask-mode-for-real-with-multi-pointer-xorg/">Chrome Multitask Mode for Real with Multi-Pointer Xorg</a> <span class="subtitle">04 April 2012</span></h2>
            </header>
            <section class="content"><p><a href="/articles/2012/Chrome%20Multitask%20Mode%20for%20Real%20with%20Multi-Pointer%20Xorg/Screenshot.png"><img src="/articles/2012/Chrome%20Multitask%20Mode%20for%20Real%20with%20Multi-Pointer%20Xorg/Screenshot.png" alt="" title="Screenshot"></a></p>
<p>Google’s multitask mode was only an April Fool’s joke, but inordinately amused among us (read: me) might even venture into attempting such an irrational feat. While watching the video, it evoked some memories of something which I had stumbled across a few years ago, called Multi-Pointer X. The rationale for creating that wasn’t nearly as insane as the Chrome Multitask video made it out to appear, instead I think it was just the framework to support multitouch and other sorts of alluring interactions on the Linux&nbsp;platform.</p>
<p>So I decided to look into that again and within a few minutes of Googling, it appears that Multi-Pointer X has now been incorporated into the X.org mainline as part of XInput2. So what exactly does it take to conjure and insult the multitasking&nbsp;gods?</p>
<p>The first step is quite logically to plug in another mouse. I happen to have three mice plugged into my computer anyway (there’s a perfectly logical rationale for how this came to be, my keyboard is some  wireless Microsoft keyboard+mouse set but I really hate the scrollbar on the Microsoft mouse, so I instead used another mouse for the longest time until it started failing and sheer lethargy prevailed over disconnecting that obsoleted peripheral) but regrettably, I don’t have an additional prehensile appendage to operate the third&nbsp;mouse.</p>
<p>Right now I’m using a pretty much unmodified version of the latest version of Ubuntu 11.10. I just opened up a terminal window and typed in “<tt>xinput list</tt>“</p>
<pre><code><span style='display:none' detected-language='java'></span>antimatter15<span class="hljs-annotation">@antimatter</span>15-desktop:~/online$ xinput list
⎡ Virtual core pointer id=<span class="hljs-number">2</span> [<span class="hljs-function">master <span class="hljs-title">pointer</span> <span class="hljs-params">(<span class="hljs-number">3</span>)</span>]
⎜ ↳ Virtual core <span class="caps">XTEST</span> pointer id</span>=<span class="hljs-number">4</span> [<span class="hljs-function">slave <span class="hljs-title">pointer</span> <span class="hljs-params">(<span class="hljs-number">2</span>)</span>]
⎜ ↳ A4Tech <span class="caps">PS</span>/2+USB Mouse id</span>=<span class="hljs-number">8</span> [<span class="hljs-function">slave <span class="hljs-title">pointer</span> <span class="hljs-params">(<span class="hljs-number">2</span>)</span>]
⎜ ↳ Microsft Microsoft Wireless Optical Desktop® 2.20 id</span>=<span class="hljs-number">11</span> [<span class="hljs-function">slave <span class="hljs-title">pointer</span> <span class="hljs-params">(<span class="hljs-number">2</span>)</span>]
⎜ ↳ <span class="caps">USB</span> Laser Wheel Mouse id</span>=<span class="hljs-number">9</span> [<span class="hljs-function">slave <span class="hljs-title">pointer</span> <span class="hljs-params">(<span class="hljs-number">2</span>)</span>]
⎣ Virtual core keyboard id</span>=<span class="hljs-number">3</span> [<span class="hljs-function">master <span class="hljs-title">keyboard</span> <span class="hljs-params">(<span class="hljs-number">2</span>)</span>]
↳ Virtual core <span class="caps">XTEST</span> keyboard id</span>=<span class="hljs-number">5</span> [<span class="hljs-function">slave <span class="hljs-title">keyboard</span> <span class="hljs-params">(<span class="hljs-number">3</span>)</span>]
↳ Power Button id</span>=<span class="hljs-number">6</span> [<span class="hljs-function">slave <span class="hljs-title">keyboard</span> <span class="hljs-params">(<span class="hljs-number">3</span>)</span>]
↳ Power Button id</span>=<span class="hljs-number">7</span> [<span class="hljs-function">slave <span class="hljs-title">keyboard</span> <span class="hljs-params">(<span class="hljs-number">3</span>)</span>]
↳ Microsft Microsoft Wireless Optical Desktop® 2.20 id</span>=<span class="hljs-number">10</span> [<span class="hljs-function">slave <span class="hljs-title">keyboard</span> <span class="hljs-params">(<span class="hljs-number">3</span>)</span>]</span>
</code></pre><p><a href="/articles/2012/Chrome%20Multitask%20Mode%20for%20Real%20with%20Multi-Pointer%20Xorg/Screenshot1.png"><img src="/articles/2012/Chrome%20Multitask%20Mode%20for%20Real%20with%20Multi-Pointer%20Xorg/Screenshot1.png" alt="" title="Screenshot"></a>Use the command “<tt>xinput create-master Auxiliary</tt>“ in order to create a new input device, and try running “<tt>xinput list</tt>“ again to confirm that the command has done your&nbsp;bidding.</p>
<pre><code><span style='display:none' detected-language='groovy'></span>antimatter15<span class="hljs-annotation">@antimatter</span>15-<span class="hljs-string">desktop:</span>~/online$ xinput create-master Auxiliary
</code></pre><p>Now it’s time for the third (or is it fourth) and final step, to reattach one of those master pointers into the auxiliary pointer. To do that, pick out some mouse. For me, I picked my “<tt>A4Tech <span class="caps">PS</span>/2+USB Mouse</tt>“ which is was my mouse with a broken scroll wheel. You can see that it’s been given <tt><span class="caps">ID</span>=8</tt>, so that’s the number I’ll be using for the next&nbsp;step.</p>
<pre><code><span style='display:none' detected-language='groovy'></span>antimatter15<span class="hljs-annotation">@antimatter</span>15-<span class="hljs-string">desktop:</span>~/online$ xinput reattach <span class="hljs-number">8</span> <span class="hljs-string">"Auxiliary pointer"</span>
</code></pre><p>And then I can now use two mice at the same time for whatever ungodly purpose I&nbsp;desire.</p>
<p>It’s hard to take screenshots since it appears that every screenshotting or screencasting app which I can find seems to make the wholly unwarranted assumption that a desktop computer only has one cursor, but it does actually work. Though I don’t think I’ll ever be able to multitask through this scheme, it’s mentally jarring in far too many&nbsp;ways.</p>

            </section>
          </article>
          <hr>
          <article class="article intro">
            <header>
              <h2><a href="/2010/07/shinytouch-opencv/">ShinyTouch/OpenCV</a> <span class="subtitle">15 July 2010</span></h2>
            </header>
            <section class="content"><p><a href="/articles/2010/ShinyTouchOpenCV/ShinyTouch_0171.png"><img src="/articles/2010/ShinyTouchOpenCV/ShinyTouch_0171.png" alt="" title="ShinyTouch_017"></a></p>
<p>I have yet to give up entirely on <a href="/2010/07/shinytouch-opencv/2009/07/shinytouch-zero-setup-single-touch-surface-retrofitting-technology/">ShinyTouch</a>, my experiment into creating a touch screen input system which requires <strong>virtually no setup</strong>. For people who haven’t read my posts from last year, it works because magically things look shinier when you look at it from an angle. And so if you mount a camera at an angle (It doesn’t need to be as extreme as the screenshot above), you end up seeing a reflection on the surface of the screen (this could be aided by a transparent layer of acrylic or by having a glossy display, but as you can see, mine are matte, but they still work). The other pretty obvious idea of ShinyTouch, is that on a reflective surface, especially observed from a non-direct angle, you can see that the distance from the reflection (I guess my eighth grade science teacher would say the “virtual image”) to the apparent finger, or “real image” is twice the distance from either to the surface of the display.  In other words, the <strong>reflection gets closer to you when you get closer to the mirror</strong>. A webcam usually gives a two-dimensional bitmap of data (and one non-spatial dimension of time). This gives (after a perspective transform) the <strong>X and Y positions</strong> of the finger. But an important aspect of a touchscreen and what this technology is also capable of, a “zero-touch screen”, is a <strong>Z axis: the distance of the finger and the screen</strong>. A touchscreen has a binary Z-axis: touch or no touch. Since you can measure the <strong>distance between the apparent real finger and it’s reflection, you can get the Z-axis</strong>. That’s how ShinyTouch&nbsp;works.</p>
<p>Last year someone was interested and actually contributed some code. Eventually we both agreed that my code was crap so he decided to <a href="http://github.com/ddlshack/shinytouch">rewrite</a> it, this time using less <span class="caps">PIL</span> and pixel manipulation, and instead, opting for more OpenCV so it’s faster. The project died a bit early this year, and with nothing more to do,<a href="http://github.com/antimatter15/shinytouch"> I decided to revive it</a>. His code had some neat&nbsp;features:</p>
<ul>
<li>Better perspective&nbsp;performs</li>
<li>Faster</li>
<li>Less&nbsp;Buggy</li>
<li>Simpler configuration (track bars instead of key combinations and editing <span class="caps">JSON</span>&nbsp;files)</li>
<li><p>Yellow square to indicate which corner to click when callibrating (actually, <a href="http://github.com/ddlshack/shinytouch/commit/9df521a08c8a12e6b8d1aa58d665394faaaac10f">I wrote</a> that feature)
It was left however, at a pretty unfinished state. It couldn’t do anything more than generate config files through a nice <span class="caps">UI</span> and doing a perspective transform on the raw video feed. So in the last few days, I added a few more&nbsp;features.</p>
</li>
<li><p>Convert perspective-transformed code into&nbsp;grayscale</p>
</li>
<li>Apply a 6x6 gaussian blur&nbsp;filter</li>
<li>Apply a binary threshold&nbsp;filter</li>
<li>Copy it over to <span class="caps">PIL</span> and shrink the canvas by 75% for performance&nbsp;reasons</li>
<li>Hack a Python flood-fill function to do blob detection (because I couldn’t compile any python bindings for the opencv blob&nbsp;library)</li>
<li>Filter those blobs (sort of)
Basically, it means ShinyTouch can now do multi-touch. Though the Z-axis processing, which is really what the project is all about still sucks. Like it sucks <em>a lot</em>. But when it does work (on a rare occasion), <strong>you get multitouch</strong> (yay). If <span class="caps">TUIO</span> gets ported (again), it’ll probably be able to interface with all the neat TUIO based&nbsp;apps.</li>
</ul>
<p>Code here: <a href="http://github.com/antimatter15/shinytouch/">http://github.com/antimatter15/shinytouch/</a> Please help, you probably don’t want to try it&nbsp;(yet).</p>

            </section>
          </article>
          <hr>
          <article class="article intro">
            <header>
              <h2><a href="/2009/03/new-idea-insanely-cheap-multitouch/">New Idea Insanely Cheap Multitouch</a> <span class="subtitle">14 March 2009</span></h2>
            </header>
            <section class="content"><p>So I’ve been thinking about a new design for a Multitouch system. I’ve googled it a bit, and it seems&nbsp;original.</p>
<p>Right now, there are a couple popular multitouch designs. The most popular one right now is probably <span class="caps">FTIR</span>, or Frustrated Total Internal Reflection. This is the one used by Jeff Han in his TED demonstrations. There are several variations of FTIR, like Diffused Surface Illumination. Then there is Diffused Illumination, which powers the Microsoft Surface, and a variation of DI is Front DI (where the light source is in front) like the simple DIY MTmini system (where the light source is ambient light). The problem with FTIR, DSI, and DI is that they require the camera to be in the back of the screen. This makes it impossible to retrofit a&nbsp;surface.</p>
<p>The Wiimote tricks by Johnny Chung Lee aren’t exactly multitouch. They involve wearing special things to interact. They are interesting nonetheless, but not true multitouch. It’s virtually a completely different market, though the Wiimote <span class="caps">IR</span> camera may be used with the LaserTouch system theoretically instead of the camera (I was planning to try this out&nbsp;originally).</p>
<p>Laser Light Plane, or <span class="caps">LLP</span> is usually similarly used as the ones above. A variant of LLP is the Microsoft Research LaserTouch system (apparently used in Touchwall as well). In LLP, a laser hooked up to a line generator creates a “plane” of infrared light only millimeters above the surface. When something interacts with that plane, light is scattered in all directions. Most systems take light from the bottom, but LaserTouch looks at the light from the top. Wherever your finger touches the plane, it appears to have something like a thin halo around&nbsp;it.</p>
<p><span class="caps">LLP</span> is interesting (especially the LaserTouch variant) because it allows for comparatively really cheap multitouch. The Aixiz 780nm 5-10mW laser (the one(s) most commonly used around nuigroup for LLP rigs). cost less than $10 (though normally 4 or so are used together, and buying goggles for protection from the dangerous light may cost close to a hundred, and the visible light filter is also a slight tax, along with disassembling a webcam to remove the IR filter, making it closer to the $100 estimate by&nbsp;microsoft).</p>
<p>Well, I have a relatively simple idea. You just have a very thin mirror angled just right off to the side of the surface (actually, 2 mirrors, for two coordinates). You are probably thinking that this is only going to be like the normal single-touch systems, which suffer from not being able to detect where you actually pushed when there is multiple points. Actually, the mirrors are only used to determine whether you’ve contacted the screen yet. The position is determined by some magical image processing that hasn’t been implemented&nbsp;yet.</p>
<p>So what do you think of this idea? Did I explain it enough? I’m probably gonna elaborate on this&nbsp;later.</p>

            </section>
          </article>
          <hr>
          <div class="nav"><a href="/archive" class="newer">« Archives</a><a href="/page/1" class="next">Latest Posts »</a>
          </div>
        </div>
      </div>
    </div>
    <script>
      function squish(){
        document.getElementById("squishfoot").className += "squish"
      }
    </script>
    <style>
      .squish { font-size: 9px }
      .squishsquish { font-size: 8px }
      .squishsquishsquish { font-size: 7px }
      .squishsquishsquishsquish { font-size: 6px }
      .squishsquishsquishsquishsquish { font-size: 5px }
      .squishsquishsquishsquishsquishsquish { font-size: 4px }
      .squishsquishsquishsquishsquishsquishsquish { visibility: hidden }
    </style>
    <div class="graybar bottom">
      <footer>
        <div id="squishfoot">I'm a tiny footer, please don't <a href="javascript:squish()">squish</a> me</div>
      </footer>
    </div>
  </body>
</html>